# 結論

## 擴展應用程式

設計與開發只是旅程的一部分。我們遲早需要設置持續整合 (CI) 和持續交付 (CD) 管線。而且我們必須將此應用程式部署到某個地方。

最初，我們可以從在任何雲端供應商的一台虛擬機上部署應用程式開始。但這是一個「單點故障（Single point of failure）」，作為 SRE（甚至一般工程師）我們絕不允許這種狀況。因此，一個改進是於負載平衡器後面部署多個應用程式實例。這確實可避免單一機器故障所帶來的問題。

在這裡擴展意味著在負載平衡器後端新增更多實例。但這種擴展有一定的極限。之後，系統中其他瓶頸將會出現，例如：資料庫會成為瓶頸，或者可能是負載平衡器本身。你怎麼知道是什麼成為瓶頸？你需要對應用程式架構的各方面擁有可觀測性。

只有擁有度量數據，你才知道哪裡出了問題。**能被度量的，才能被修復！**

想更深入了解擴展性，請參考 School Of SRE 的[擴展性模組](../systems_design/scalability.md)，並在學習後，將你的體會與收穫應用到此應用程式中。思考如何讓此應用程式具備地理分布、高可用與可擴展性。

## 監控策略

應用程式一旦部署，它會正常運作。但不會永遠如此。可靠性是我們工作的核心，我們透過設計讓系統可靠，但問題仍然會發生。機器會故障，硬碟會異常行為，有瑕疵的程式碼會被推送到生產環境。所有這些可能的情況都會讓系統的可靠性降低。那我們怎麼做？**我們監控！**

我們監控系統健康狀態，一旦有任何異常，我們希望能立即收到警報。

現在以 URL 縮短應用程式為例，我們需要監控它，並在發生問題時獲得通知。但我們首先要決定的是，什麼是我們需要監控的「某個東西」。

1. 由於它是一個提供 HTTP 請求服務的網頁應用，我們想監控 HTTP 狀態碼與延遲。
2. 請求量也是監控重點之一，如果應用接收到異常的流量，可能就有問題。
3. 我們也要監控資料庫，依照所選用的資料庫方案，監控如查詢時間、請求量、硬碟使用率等。
4. 最後，必須有一些外部監控，從你資料中心外的裝置周期性測試。這模擬顧客使用情況，確保系統從客戶端觀點依然正常運作。

## SRE 角色中的應用

在 SRE 世界裡，Python 是被廣泛用來撰寫小工具與腳本的語言。由於 SRE 開發的工具會操作關鍵基礎設施，且具有極大權限（可能會造成系統崩潰），使用程式語言及其特性時必須非常謹慎。同時，在調試問題時，了解語言本身與其特性也非常重要。作為 SRE，對 Python 語言有深入了解，對我解決非常棘手的除錯問題有極大幫助，也讓我在做設計決策時更加敏銳與有自信。

雖然編寫工具未必是 SRE 的主要工作，但支援工具或服務更可能是日常任務。打造一款應用或工具只是產品化的一小部分。雖然在設計應用本身需要考慮其健壯性，但作為 SRE，你要負責該產品部署後的可靠性與穩定性。為了確保這點，你必須先理解應用，然後擬定監控策略，並為各種失效情境做好準備。

## 選擇性練習

1. 製作一個裝飾器，用以依據函數輸入參數緩存函數回傳值。
2. 將 URL 縮短應用部署到任何雲端供應商。
3. 使用多種可用的監控工具（例如 Catchpoint、Datadog 等）來設置監控。
4. 在 TCP socket 之上打造一個簡易版類 Flask 框架。

## 總結

本模組的第一部分，旨在讓你更了解選擇 Python 作為程式語言時會發生的事，以及 Python 程式運作的內部機制。理解 Python 如何內部以物件形式處理事物後，很多表面看似神奇的現象會變得更易理解。

第二部分將先解釋像 Flask 這樣的框架如何運作，並且基於 TCP、HTTP 等協定的知識。接著探討應用程式整個開發生命週期，包括與 SRE 相關的內容。雖然設計與架構範疇不會涵蓋所有細節，但會提供作為 SRE 必須關注的重要面向，以及為何這些面向如此重要的概述。
