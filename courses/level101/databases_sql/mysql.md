### MySQL 架構

![alt_text](images/mysql_architecture.png "MySQL 架構圖")

MySQL 架構讓您可以根據需求選擇合適的儲存引擎，並且對終端使用者（應用程式工程師及[資料庫管理員 (DBA)](https://en.wikipedia.org/wiki/Database_administrator)）抽象化所有實作細節，只需了解一致且穩定的 API。

應用層：

*   連線處理：每個客戶端獲得一個獨立連線，並於存取期間快取
*   認證：伺服器會檢查客戶端的（使用者名稱、密碼、主機）資訊，決定允許或拒絕連線
*   安全性：伺服器決定客戶端是否有權限執行每個查詢（可使用 `SHOW PRIVILEGES` 指令查詢）

伺服器層：

*   服務與工具：備份/還原、複寫、叢集等
*   SQL 介面：客戶端執行資料存取和操作的查詢
*   SQL 解析器：從查詢中建立語法樹（詞法/語法/語意分析及程式碼生成）
*   優化器：利用各種演算法及可用資料（表層統計資訊）優化查詢，修改查詢內容、掃描順序、使用索引等（可使用 `EXPLAIN` 指令查詢）
*   快取與緩衝區：快取用於儲存查詢結果，緩衝池（InnoDB）以[最近最少使用 (LRU)](https://en.wikipedia.org/wiki/Cache_replacement_policies#Least_recently_used_(LRU))方式儲存表與索引資料

儲存引擎選項：

*   InnoDB：使用最廣泛，支援交易，符合 ACID，支援列鎖定、崩潰復原及多版本併發控制，MySQL 5.5+ 預設引擎。
*   MyISAM：速度快，不支援交易，提供表級鎖定，適合讀取密集型工作負載，常用於網站及資料倉儲，MySQL 5.1 以前預設。
*   Archive：優化高速插入，插入時壓縮資料，不支援交易，適合儲存及檢索大量少被訪問的歷史存檔資料。
*   Memory：資料表存在記憶體中，速度最快，支援表級鎖定，不支援交易，適合建立暫存表或快速查詢，資料在系統關機後會遺失。
*   CSV：將資料儲存為 CSV 檔案，適合整合使用此格式的其他應用程式。
*   … 等等。

可以從一種儲存引擎遷移到另一種，但此遷移會鎖定資料表的所有操作而非線上進行，因為它會改變資料的物理排列。遷移耗時且通常不建議，因此在開始時選擇合適的儲存引擎非常重要。

一般建議除非有特殊需求，否則使用 InnoDB。

執行 `mysql> SHOW ENGINES;` 可查看您 MySQL 伺服器支援的引擎清單。
